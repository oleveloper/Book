---
layout: post
title: "Kubernetes_52 Service Accounts"
date: 2023-01-19
last_modified_at: 2023-01-19
categories: [Kubernetes]
tags: [Kubernetes]
---

# Service Accounts

서비스 계정의 개념은 인증, 권한 부여, 역할 기반 액세스 제어 등과 같은 쿠버네티스의 보안 관련 개념들과 연결된다.   

쿠버네티스에는 사용자 계정과 서비스 계정이라는 두 가지 타입의 계정이 있다.   
사용자 계정은 사람이 사용하고, 서비스 계정은 시스템이 사용한다.   

## User Account
사용자 계정은 관리 작업을 수행하기 위해 클러스터에 액세스하는 관리자 또는 애플리케이션을 배포하기 위해 클러스터에 액세스하는 개발자를 위한 계정이 이에 속한다.   

예를 들어, Prometeus와 같은 모니터링 애플리케이션은 서비스 계정을 사용해 성능 메트릭에 대한 Kubernetes API를 가져온다.   
또, Jenkins와 같은 자동화 빌드 도구는 서비스 계정을 사용해 쿠버네티스 클러스터에 애플리케이션을 배포한다.    

예를 들어, "My Kubernetes Dashboard" 라는 간단한 쿠버네티스 대시보드 애플리케이션을 만들었다고 하자.   
쿠버네티스 API에 요청을 전송해 쿠버네티스 클러스터의 Pod 목록을 검색하고 웹 페이지에 표시하는 심플한 애플리케이션이다.   
내 애플리케이션이 쿠버네티스 API를 쿼리하려면 인증을 받아야한다. 이걸 위해 우리는 서비스 계정을 사용한다.   

## Service Account
위에서 설명했듯이, 사람이 아니라 애플리케이션이나 시스템 프로그램의 식별, 인증, 인가를 위한 계정을 의미한다.   
서비스 계정을 생성하려면 kubectl 명령에서 서비스 계정을 생성한 다음 계정이름을 입력한다.    
kubectl에서 모든 서비스 계정을 보려면 아래의 명령을 수행한다.    
```
get service account
```

서비스 계정이 생성되면 토큰도 자동으로 생성된다.   
서비스 계정 토큰은 쿠버네티스 API에 인증 할 때 외부 애플리케이션에서 사용해야 하는 토큰이다.   
이 토큰은 secret object로 저장된다.   

정리하자면, 서비스 계정이 생성되면 먼저 서비스 계정 오브젝트를 생성한 다음 서비스 계정에 대한 토큰을 생성한다. 그 다음 secret object를 만들고, 토큰을 이 곳에 저장한다.   
그러면 secret object가 서비스 계정에 연결된다.   
토큰을 보려면 아래의 명령을 실행해 secret을 볼 수 있다.   
```
kubectl descript secret
```
