---
layout: post
title: "Kubernetes_11"
date: 2023-01-04
last_modified_at: 2023-01-04
categories: [Kubernetes]
tags: [Kubernetes]
---

# Kubernetes Services
쿠버네티스 서비스는 애플리케이션 내,외부의 다양한 구성 요소 간 통신을 가능하게 한다.   
또한 애플리케이션을 다른 애플리케이션 또는 유저에 연결할 수 있도록 도와준다.   
예를 들어, 애플리케이션에는 유저에게 프론트엔드 부하를 제공하거나 백엔드 프로세스를 실행하는 다른 그룹,   
외부 데이터 소스에 연결하는 세번째 그룹 등 다양한 섹션을 실행하는 pod 그룹이 있을 수 있다.    
이러한 pod 그룹 간의 연결을 가능하게 하는 것이 바로 서비스이다.   

서비스를 통해 프론트엔드 애플리케이션을 엔드유저가 사용할 수 있다.    
백엔드와 프론트엔드 pod간의 통신을 돕고 외부 데이터소스에 대한 연결을 설정하는 데에 도움이 된다.   
따라서 서비스를 애플리케이션에서 마이크로 서비스 간의 느슨한 결합을 가능하게 한다.   

지금까지는 pod가 내부 네트워킹을 통해 서로 통신하는 방법에 대해 이야기했고,   
이제는 서비스를 활용한 사례를 이야기해보자.   
예를 들어, 웹 애플리케이션을 실행하는 pod을 deploy했다고 하자.   
외부 사용자가 이러한 웹 페이지에 액세스하려면 어떻게 해야할까?   

일단 설정에 대해 이야기하겠다.   
쿠버네티스 노드에는 IP 주소가 있으며, 이 주소는 192.168.1.2 이다.   
노트북도 같은 네트워크에 있어서 IP가 192.168.1.1 이다.   
내부 Pod 네트워크의 범위는 10.244.0.0이다.   
그리고 pod는 IP 10.244.0.2를 가지고 있다.   

주소 10.244.0.2의 pod가 별도의 네트워크에 있기 때문에 ping을 하거나 액세스 할 수 없다.   
그렇다면 웹 페이지를 볼 수 있는 옵션은 무엇일까?   

첫째, 노드에서 192.168.1.2에 있는 쿠버네티스 노드에 SSH를 입력하면   
curl을 수행해 pod의 웹페이지에 액세스 할 수 있다.   
또는 노드에 GUI가 있는 경우 브라우저를 켜고 주소 http://10.244.0.2 를 입력하면 pod의 웹 페이지를 볼 수 있다.   
그러나 이것은 쿠버네티스 노드 내부를 이용한 것이며, 원하는 방법이라고는 볼 수 없다.   

여기서 원하는 것은 단순히 쿠버네티스 노드 IP에 액세스하는 것만으로,    
노드에 SSH를 입력하지 않고 내 랩탑에서 웹 서버에 액세스 할 수 있기를 원하는 것이다.    
따라서 랩탑에서 노드를 통해 웹 컨테이너를 실행하는 pod에 요청을 매핑하는 데에 도움이 되는 무언가가 필요하다.    

여기가 바로 Kubernetes services가 동작하는 부분이다.   

쿠버네티스 서비스는 이전에 언급했던 Pods, Replica set, Deployment와 같은 오브젝트이다.   

- Node Port Service   
usecase 중 하나는, 노드의 포트를 수신하고 해당 포트의 요청을 웹 애플리케이션을 실행하는 pod의 포트로 전달하는 것이다.   
이러한 유형의 서비스는 노드의 포트를 수신하고 pod에 요청을 전달하기 때문에 node port service라고 한다.   
즉, 노드의 포트에서 내부 포트에 액세스한다.   

- Cluster IP   
이 경우 서비스는 백엔드 서버 그룹과 같은 서로 다른 서비스 간의 통신을 가능하기 위해    
클러스터 내부에 가상 IP를 생성한다.   

- Load Balancer    
지원되는 클라우드 제공자에서 애플리케이션에 대한 로드 밸런서를 프로비저닝 한다.






